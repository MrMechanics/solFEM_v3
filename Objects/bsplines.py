



def cox_de_boor(u, k, d, knots):
    """Cox-de Boor recursion formula."""
    if d == 0:
        return 1.0 if knots[k] <= u < knots[k+1] else 0.0
    else:
        term1 = (u - knots[k]) / (knots[k+d] - knots[k]) * cox_de_boor(u, k, d-1, knots) if knots[k+d] != knots[k] else 0
        term2 = (knots[k+d+1] - u) / (knots[k+d+1] - knots[k+1]) * cox_de_boor(u, k+1, d-1, knots) if knots[k+d+1] != knots[k+1] else 0
        
        return term1 + term2

def evaluate_bspline(u, control_points, degree, knots):
    """Evaluate B-spline curve at parameter u."""
    n = len(control_points)
    point = [0, 0, 0]  # Assuming 3D control points
    for i in range(n):
        point[0] += control_points[i][0] * cox_de_boor(u, i, degree, knots)
        point[1] += control_points[i][1] * cox_de_boor(u, i, degree, knots)
        point[2] += control_points[i][2] * cox_de_boor(u, i, degree, knots)
    return point


crt_pnts = {11: (220.78255478716954, 38.5114004723742, 55.47704050721999), 12: (211.34476961198268, 40.00000000000001, 48.36323171829537), 14: (211.3397459621557, 40.0, 49.641016151377535), 19: (54.99999999999999, 20.0, 10.0), 24: (219.7023389797287, 32.61718631093049, 44.81130832164887), 29: (219.70625104779904, 7.399390466614757, 44.809092880078694), 34: (219.77588317136747, 7.718033760251681, 44.76950636602565), 36: (185.0, 0.0, 15.0), 37: (200.0, 0.0, 60.00000000000001), 51: (0.0, 0.0, 0.0), 52: (5.0, 0.0, 10.0), 53: (222.8139799806035, 3.3650756374544737, 54.494251708292545), 56: (185.0, 0.0, 10.0), 57: (60.0, 20.0, 10.0), 58: (216.46345644445333, 40.00000000000001, 57.216459900015394), 62: (5.0, 40.0, 10.0), 69: (5.0, 0.0, 10.0), 72: (225.00000000000003, 9.33703912091788, 53.30127018922189), 73: (221.98793632394128, 37.551536883112995, 54.908199492113276), 76: (216.2300014632561, 38.17018521405198, 46.56039787789767), 79: (224.77701689419473, 32.276659284863065, 53.429293375834575), 81: (217.1654386577453, 37.338944000039945, 46.13035072343833), 84: (215.47359997234437, 38.71039786569735, 46.88997514021626), 89: (217.7964266251985, 36.64772250678386, 45.82604234659242), 94: (219.94327689509595, 8.682055931762795, 44.67394150171297), 98: (219.9939505769237, 0.9958311294465869, 55.83244361820755), 105: (5.0, 35.0, 0.0), 110: (212.8992161050521, 0.2484411008971289, 47.86444119118249), 112: (0.0, 0.0, 0.0), 114: (223.82358590667928, 4.974913575638013, 53.95976485107109), 117: (190.0, -1.2246467991473537e-15, 60.00000000000001), 119: (220.52232729210934, 1.3002234950656817, 55.597521034674706), 126: (25.0, 20.0, 0.0), 132: (224.4394173824657, 6.451662941795364, 53.62030164425332), 133: (200.0, 40.0, 10.0), 135: (223.84070261489703, 35.02468711057605, 53.95172866319504), 137: (0.0, 35.0, 10.0), 142: (29.999999999999996, 20.0, 10.0), 143: (200.0, 40.0, 10.0), 156: (211.97015954858696, 39.93848856270649, 48.17236999956753), 157: (200.0, 40.0, 60.00000000000001), 161: (205.00000000000003, 0.0, 44.64101615137755), 164: (5.0, 5.0, 10.0), 181: (221.50903410301916, 2.0373152053180053, 55.137870333089914), 186: (0.0, 40.0, 10.0), 188: (218.2751864927866, 0.32666515175138866, 56.54156562480228), 191: (190.0, 0.0, 10.0), 193: (200.0, 40.0, 10.0), 200: (190.0, 0.0, 10.0), 202: (190.0, 40.0, 60.00000000000001), 206: (224.77446262606293, 7.710309148319249, 53.430751974510045), 209: (224.7077677599061, 32.59457796150652, 53.46878651505813), 212: (185.0, 40.0, 15.0), 213: (65.0, 20.0, 10.0), 216: (218.2917130044913, 39.66864763380483, 56.53506589217681), 217: (216.47503262268836, 37.97476778787806, 46.45051102472937), 221: (219.2148714684231, 34.16086112220439, 45.0828263568153), 225: (213.78577466117653, 39.49200560516249, 47.550670980074685), 236: (220.00000000000006, 40.0, 44.64101615137753), 238: (0.0, 0.0, 0.0), 241: (217.0776712116328, 0.06268379327675208, 56.99750263701568), 245: (205.71428571428575, 40.0, 49.58973274443148), 247: (0.0, 5.0, 0.0), 249: (211.97352275596307, 0.06152834173453399, 48.17142234963027), 252: (190.0, -1.2246467991473537e-15, 60.00000000000001), 258: (219.15219142566298, 0.6240245353556149, 56.187512387191035), 262: (225.00000000000006, 10.000000000000002, 53.30127018922191), 266: (224.53627710181954, 6.759571125819274, 53.56581636495447), 270: (215.8346433899875, 40.0, 57.42640687119283), 272: (200.0, 40.0, 10.0), 273: (225.00000000000006, 10.000000000000002, 53.30127018922191), 276: (190.0, 0.0, 0.0), 280: (200.0, 0.0, 60.00000000000001), 285: (5.0, 5.0, 10.0), 288: (216.94346712307004, 37.55839686048453, 46.23514006778514), 290: (200.0, 0.0, 44.64101615137755), 291: (200.0, 0.0, 44.64101615137755), 303: (218.1708413454988, 36.14340373097553, 45.636471940543956), 310: (215.7375898808724, 1.4774406461854703, 46.775056850352144), 322: (220.00000000000006, 10.000000000000002, 44.64101615137752), 329: (219.53838334702658, 6.7676257482789, 44.9035937072024), 336: (224.21952932944419, 5.848372852461881, 53.742773535639074), 341: (224.1117535181267, 34.448870854821834, 53.80282168746685), 347: (219.99139965584234, 38.98697876665422, 55.83042939038532), 352: (224.44285994837497, 33.538102279450754, 53.6183740976192), 358: (220.00000000000006, 30.0, 44.64101615137753), 362: (200.0, 0.0, 10.0), 367: (5.0, 40.0, 10.0), 370: (195.0, 0.0, 1.3397459621556225), 373: (205.00000000000003, 0.0, 44.64101615137755), 380: (29.999999999999996, 20.0, 10.0), 381: (29.999999999999996, 20.0, 10.0), 385: (224.0965012373734, 5.552991079510226, 53.81076122748451), 387: (25.0, 20.0, 10.0), 390: (213.80038649828214, 0.5131463337700316, 47.54529584151132), 402: (186.33974596215563, 30.0, 6.339745962155633), 403: (222.80811350820997, 36.617259003528964, 54.495328709561946), 410: (190.0, 40.0, 10.0), 414: (190.0, -1.2246467991473537e-15, 15.0), 417: (0.0, 5.0, 10.0), 419: (224.94352706281492, 31.31484821030614, 53.334014525135785), 420: (190.0, -1.2246467991473537e-15, 15.0), 423: (218.81597992042882, 35.035573767490405, 45.298488285902934), 435: (218.16815909568538, 3.8804026384395667, 45.636536136304414), 440: (0.0, 0.0, 10.0), 446: (60.0, 20.0, 0.0), 447: (205.00000000000003, 40.0, 44.64101615137755), 448: (223.18438307744822, 3.868886263647459, 54.301473197853475), 452: (220.00000000000006, 10.000000000000002, 44.64101615137752), 456: (185.0, -1.2246467991473537e-15, 15.0), 459: (60.0, 20.0, 10.0), 461: (185.0, 40.0, 10.0), 471: (217.99112571403973, 39.74796397136609, 56.6521657932335), 473: (0.0, 5.0, 10.0), 476: (0.0, 40.0, 0.0), 479: (224.5409133906861, 33.2249204040898, 53.563204183347175), 483: (223.18198492593763, 36.10722638988869, 54.30169176982925), 488: (205.71428571428575, 0.0, 49.58973274443148), 490: (219.53382003629224, 33.24759838339432, 44.90614878680807), 494: (225.00000000000006, 30.0, 53.3012701892219), 498: (215.8346433899875, 0.0, 57.42640687119283), 510: (216.96054560331817, 2.435858068935019, 46.22923625555613), 511: (54.99999999999999, 20.0, 10.0), 512: (0.0, 0.0, 0.0), 515: (219.43971458129258, 6.453812356439458, 44.958741460735425), 516: (185.0, 40.0, 10.0), 519: (221.9713334721481, 2.4542220431366935, 54.91465675820469), 521: (214.09079218790404, 0.6210839476780404, 47.43717199699997), 526: (0.0, 40.0, 10.0), 528: (222.19053488033956, 2.673820113824747, 54.806631106717965), 530: (219.10637060777458, 5.541356890299597, 45.142723745905194), 535: (221.26759222248077, 1.8417019270894948, 55.25223178536381), 547: (65.0, 20.0, 0.0), 549: (225.00000000000006, 30.0, 53.30127018922191), 551: (5.0, 5.0, 0.0), 552: (29.999999999999996, 20.0, 10.0), 555: (190.0, -1.2246467991473537e-15, 60.00000000000001), 559: (0.0, 35.0, 10.0), 561: (217.08110450737746, 39.93730212600615, 56.99634644777137), 562: (219.16171893736583, 39.372089368516036, 56.18354780022868), 564: (219.0909547476156, 34.456747076427, 45.15053089870052), 575: (219.7735110269472, 32.294033728751174, 44.77085715738629), 578: (0.0, 0.0, 10.0), 579: (0.0, 0.0, 60.00000000000001), 583: (5.0, 40.0, 0.0), 584: (218.83326736818603, 4.9645656113309276, 45.29083278694408), 586: (190.0, 0.0, 0.0), 588: (225.00000000000006, 40.0, 53.30127018922191), 589: (205.71428571428575, 0.0, 49.58973274443149), 590: (216.49836317532177, 2.0229316582509953, 46.44324599916779), 593: (215.8346433899875, 40.0, 57.42640687119283), 602: (60.0, 20.0, 0.0), 604: (216.46336482115692, 2.210755992333724e-16, 57.21649049103677), 606: (217.5908489459127, 3.1274552146062686, 45.92515066172816), 607: (200.0, 40.0, 44.64101615137755), 618: (224.70369199817753, 7.3881201703705175, 53.47110363472936), 620: (222.61078179584945, 36.85985636701794, 54.596036572018), 622: (54.99999999999999, 20.0, 0.0), 623: (200.0, 0.0, 10.0), 627: (219.71928014100527, 39.125160044723344, 55.94824861484022), 630: (221.53186466171496, 37.96484359473435, 55.12961324117148), 633: (200.0, 0.0, 10.0), 637: (0.0, 0.0, 10.0), 646: (218.66418695596735, 35.319717938466326, 45.37912558509346), 650: (200.0, 40.0, 60.00000000000001), 659: (210.70466269319277, 0.0, 48.541019662496836), 661: (29.999999999999996, 20.0, 0.0), 665: (60.0, 20.0, 10.0), 668: (210.70466269319277, 0.0, 48.541019662496836), 670: (220.00000000000006, 9.335446495198415, 44.641016151377514), 674: (200.0, 0.0, 60.00000000000001), 682: (29.999999999999996, 20.0, 0.0), 683: (216.3397459621557, 0.0, 58.3012701892219), 690: (190.0, -1.2246467991473537e-15, 60.00000000000001), 694: (223.35695335805687, 35.841706201548696, 54.209570437217835), 696: (5.0, 0.0, 0.0), 703: (214.08118177926121, 39.38274083929825, 47.44080298639199), 707: (210.70466269319277, 40.0, 48.541019662496836), 710: (212.88692702687294, 39.754363845802665, 47.86859846303636), 713: (34.99999999999999, 20.0, 10.0), 718: (215.8346433899875, 0.0, 57.42640687119283), 721: (213.20533208619966, 0.3269370400042776, 47.75869584376241), 723: (34.99999999999999, 20.0, 10.0), 732: (225.00000000000006, 30.0, 53.30127018922191), 733: (223.67285321920346, 4.690839164593298, 54.041231329375336), 734: (217.79038012367258, 3.3701056595276917, 45.82662540312025), 738: (217.97841057076732, 0.24904875314683128, 56.657044273948145), 740: (211.34490789326577, 6.725441601199146e-16, 48.36319331104757), 743: (34.99999999999999, 20.0, 0.0), 751: (0.0, 0.0, 10.0), 754: (190.0, 40.0, 60.00000000000001), 757: (60.0, 20.0, 10.0), 758: (200.0, 0.0, 10.0), 759: (200.0, 0.0, 10.0), 763: (220.00000000000006, 10.0, 44.64101615137752), 766: (220.5223557752775, 38.68061808498513, 55.59514482639182), 768: (220.00000000000006, 30.0, 44.64101615137753), 770: (214.93688788262406, 39.01338021279168, 47.11149437367867), 774: (219.94327767207, 31.32106099798881, 44.67394784075437), 779: (219.43630417382983, 33.556286649804036, 44.960636018139596), 783: (213.18894685125744, 39.677579968530615, 47.76442975893142), 786: (218.34496811953753, 4.146358907481057, 45.54568685976627), 787: (200.0, 0.0, 10.0), 794: (218.86174275503365, 0.5139030864310029, 56.306958790195274), 808: (0.0, 0.0, 10.0), 814: (5.0, 35.0, 10.0), 824: (200.0, 0.0, 10.0), 827: (5.0, 35.0, 10.0), 829: (225.00000000000006, 30.662980618672, 53.301270189221924), 835: (65.0, 20.0, 10.0), 837: (220.0, 30.66452594212863, 44.64101615137752), 839: (218.87627743529217, 39.48083680772476, 56.30102884832897), 845: (186.33974596215563, 10.0, 6.339745962155633), 852: (190.0, 40.0, 15.0), 854: (214.9342711448265, 1.0038924508027558, 47.10865831748451), 856: (200.0, 40.0, 10.0), 858: (210.70466269319277, 40.0, 48.541019662496836), 859: (215.47352919180122, 1.308886578295049, 46.887055603578425), 861: (0.0, 35.0, 0.0), 863: (190.0, 40.0, 0.0), 872: (25.0, 20.0, 10.0), 874: (214.65773458965347, 0.866457439257584, 47.21885393607564), 885: (224.94352604653213, 8.681777785214296, 53.33402093381554)}
cnt_pnts = [707, 12, 156, 710, 783, 225, 703, 770, 84, 76, 217, 288, 81, 89, 303, 646, 423, 564, 221, 779, 490, 24, 575, 774, 837, 358]

# Given B-spline data (dummy control points for illustration)
degree = 3
control_points = [crt_pnts[x] for x in cnt_pnts]  # Just dummy 3D control points for illustration; replace this with the actual data
knot_multiplicities = [4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4]
knots = [0.0, 0.0019655639701225084, 0.0029483459551837656, 0.003931127940245024, 0.005896691910367474, 0.006879473895428693, 0.007862255880489912, 0.009827819850612277, 0.010810601835673438, 0.011793383820734598, 0.012776165805795757, 0.013758947790856915, 0.01572451176097922]

# Compute the actual knots from the multiplicities
actual_knots = []
for k, m in zip(knots, knot_multiplicities):
    actual_knots.extend([k] * m)

# Evaluate curve at various points within knot range
num_samples = 20
us = [actual_knots[0] + i*(actual_knots[-1] - actual_knots[0])/(num_samples-1) for i in range(num_samples)]
curve_points = [evaluate_bspline(u, control_points, degree, actual_knots) for u in us]

print(curve_points)